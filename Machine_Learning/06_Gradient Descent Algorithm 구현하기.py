{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e6f073dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1493ae20",
   "metadata": {},
   "source": [
    "### 사용할 데이터셋 생성"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d3c3ab99",
   "metadata": {},
   "source": [
    "#### 문제 생성(공부한시간)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "afdb48a9",
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(100,)\n",
      "[0.3087244  0.69271769 0.10761588 0.77715302 0.37547387 0.90675537\n",
      " 0.38333169 0.05580963 0.13074444 0.92564245 0.53420467 0.09372329\n",
      " 0.65669399 0.07852035 0.59008081 0.4097613  0.77256135 0.35023596\n",
      " 0.11387482 0.12679007 0.47776791 0.84188184 0.92207557 0.07516616\n",
      " 0.01574937 0.92571157 0.82638035 0.27722266 0.05414582 0.77111187\n",
      " 0.12002364 0.89284992 0.0374459  0.18559783 0.77262026 0.13868317\n",
      " 0.31550949 0.46531983 0.19993257 0.87113538 0.49445396 0.06113929\n",
      " 0.47810957 0.68004683 0.62849444 0.78655987 0.29159545 0.54050119\n",
      " 0.5621476  0.79861852 0.84263364 0.17871085 0.79142631 0.72828427\n",
      " 0.54642447 0.07688303 0.87692046 0.81200363 0.5839901  0.13455934\n",
      " 0.59765366 0.31417991 0.76739827 0.88216513 0.80616689 0.90137989\n",
      " 0.4954783  0.16913799 0.52596111 0.35052135 0.71548939 0.32136956\n",
      " 0.37958453 0.15751992 0.89403085 0.37413024 0.22424882 0.18698779\n",
      " 0.07315812 0.81407771 0.17992022 0.44417663 0.12545075 0.10528932\n",
      " 0.87866104 0.81402335 0.66689397 0.13790761 0.65883476 0.93475143\n",
      " 0.5647815  0.87123734 0.54431152 0.37927973 0.03362562 0.79360206\n",
      " 0.18779362 0.44476804 0.73058696 0.39183464]\n"
     ]
    }
   ],
   "source": [
    "# 0.0~1.0 사이의 균등분포를 가진 100개 데이터가 랜덤하게 추출\n",
    "x = np.random.uniform(low=0.0, high=1.0, size=100)\n",
    "print(x.shape)\n",
    "print(x)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8d294df1",
   "metadata": {},
   "source": [
    "#### 정답 생성 (성적)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7c583f3f",
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(100,)\n",
      "[ 8.08724396 11.92717689  6.0761588  12.77153022  8.75473871 14.06755371\n",
      "  8.83331693  5.55809629  6.30744443 14.25642454 10.34204672  5.9372329\n",
      " 11.56693987  5.7852035  10.90080809  9.09761301 12.72561352  8.50235962\n",
      "  6.13874824  6.26790067  9.77767905 13.41881845 14.22075572  5.75166158\n",
      "  5.1574937  14.25711568 13.26380351  7.77222661  5.54145816 12.71111874\n",
      "  6.20023643 13.9284992   5.37445901  6.85597832 12.72620256  6.38683167\n",
      "  8.15509492  9.65319827  6.9993257  13.71135383  9.94453964  5.61139289\n",
      "  9.78109574 11.80046826 11.28494442 12.86559867  7.91595449 10.40501186\n",
      " 10.62147598 12.98618523 13.42633644  6.7871085  12.91426308 12.28284273\n",
      " 10.46424469  5.76883027 13.76920458 13.12003625 10.83990098  6.34559344\n",
      " 10.97653659  8.14179908 12.67398266 13.82165129 13.06166893 14.01379892\n",
      "  9.95478305  6.69137988 10.25961105  8.50521352 12.15489389  8.21369562\n",
      "  8.79584528  6.5751992  13.94030847  8.74130239  7.24248817  6.86987787\n",
      "  5.73158124 13.14077714  6.79920224  9.4417663   6.25450752  6.05289315\n",
      " 13.78661041 13.14023345 11.66893973  6.37907608 11.5883476  14.3475143\n",
      " 10.64781496 13.71237343 10.44311523  8.79279727  5.33625625 12.93602059\n",
      "  6.87793622  9.44768043 12.30586957  8.91834644]\n"
     ]
    }
   ],
   "source": [
    "y = 10 * x + 5\n",
    "print(y.shape)\n",
    "print(y)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "412e5b0a",
   "metadata": {},
   "source": [
    "### 경사하강법을 이용한 학습"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "9fc044be",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "초기 가중치 : 0.8612226693306688\n",
      "초기 절편 : 0.059646402249113994\n"
     ]
    }
   ],
   "source": [
    "num_epoch = 500 # 경사하강법을 적용할 최대 반복 횟수\n",
    "learning_rate = 1.0 # 학습률\n",
    "\n",
    "# 초기 가중치와 절편을 셋팅\n",
    "w = np.random.uniform(low=0.0, high=1.0)\n",
    "b = np.random.uniform(low=0.0, high=1.0)\n",
    "\n",
    "print(\"초기 가중치 :\",w)\n",
    "print(\"초기 절편 :\",b)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "7486edff",
   "metadata": {
    "collapsed": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MSE : 94.75628713189562\n",
      "epoch : 1  w : 6.172484150543257  b : 9.414817078933805\n",
      "MSE : 7.852778820439603\n",
      "epoch : 2  w : 5.264650990578141  b : 6.849020030870348\n",
      "MSE : 2.1354154841579858\n",
      "epoch : 3  w : 5.8868490099750845  b : 7.287581689002235\n",
      "MSE : 1.5563517053029636\n",
      "epoch : 4  w : 6.0980645060457315  b : 6.987006421313639\n",
      "MSE : 1.3297206623248792\n",
      "epoch : 5  w : 6.386889344660836  b : 6.884971133041671\n",
      "MSE : 1.1506929607374343\n",
      "epoch : 6  w : 6.6325746093612565  b : 6.745443843536646\n",
      "MSE : 0.9966995625351253\n",
      "epoch : 7  w : 6.867037946455838  b : 6.626756686229318\n",
      "MSE : 0.8633731680952234\n",
      "epoch : 8  w : 7.083803082808086  b : 6.513490687120753\n",
      "MSE : 0.7478852471493883\n",
      "epoch : 9  w : 7.2859150133736215  b : 6.4087744442953865\n",
      "MSE : 0.6478456402401865\n",
      "epoch : 10  w : 7.473932873520385  b : 6.311136962755867\n",
      "MSE : 0.5611876769432066\n",
      "epoch : 11  w : 7.648947478211407  b : 6.220308131930231\n",
      "MSE : 0.4861213687094223\n",
      "epoch : 12  w : 7.8118310401188165  b : 6.135760994179127\n",
      "MSE : 0.42109617665773913\n",
      "epoch : 13  w : 7.96343120727598  b : 6.057074195610008\n",
      "MSE : 0.36476896802189046\n",
      "epoch : 14  w : 8.104527908685501  b : 5.983838249167964\n",
      "MSE : 0.315976271947957\n",
      "epoch : 15  w : 8.235849293453716  b : 5.9156763819263265\n",
      "MSE : 0.27371024727120674\n",
      "epoch : 16  w : 8.358072497952167  b : 5.852236835110987\n",
      "MSE : 0.2370978649738759\n",
      "epoch : 17  w : 8.47182788721945  b : 5.793192493495296\n",
      "MSE : 0.2053828752690762\n",
      "epoch : 18  w : 8.57770211803908  b : 5.738238836437413\n",
      "MSE : 0.17791018682703313\n",
      "epoch : 19  w : 8.676241211578827  b : 5.687092458149711\n",
      "MSE : 0.1541123354873764\n",
      "epoch : 20  w : 8.76795335754348  b : 5.639489583349164\n",
      "MSE : 0.13349776296095042\n",
      "epoch : 21  w : 8.853311537995042  b : 5.595184712609878\n",
      "MSE : 0.11564066341099542\n",
      "epoch : 22  w : 8.932755965894147  b : 5.553949354831808\n",
      "MSE : 0.10017218818900224\n",
      "epoch : 23  w : 9.006696355572053  b : 5.515570849215083\n",
      "MSE : 0.08677282705400652\n",
      "epoch : 24  w : 9.075514035680861  b : 5.479851268426354\n",
      "MSE : 0.0751658085050314\n",
      "epoch : 25  w : 9.139563915810236  b : 5.446606397861736\n",
      "MSE : 0.06511138290675503\n",
      "epoch : 26  w : 9.199176316839937  b : 5.415664785601432\n",
      "MSE : 0.05640187032307776\n",
      "epoch : 27  w : 9.254658674486036  b : 5.386866858191716\n",
      "MSE : 0.048857370768748395\n",
      "epoch : 28  w : 9.306297124821821  b : 5.360064097685287\n",
      "MSE : 0.04232204827183278\n",
      "epoch : 29  w : 9.354357979951487  b : 5.335118275698025\n",
      "MSE : 0.03666091199219951\n",
      "epoch : 30  w : 9.399089101446705  b : 5.311900740531417\n",
      "MSE : 0.031757027908176735\n",
      "epoch : 31  w : 9.440721178629303  b : 5.290291753684324\n",
      "MSE : 0.027509103477166588\n",
      "epoch : 32  w : 9.47946891829246  b : 5.270179872332274\n",
      "MSE : 0.02382939537999447\n",
      "epoch : 33  w : 9.515532151996096  b : 5.251461374589595\n",
      "MSE : 0.020641897132250203\n",
      "epoch : 34  w : 9.549096866647043  b : 5.234039724590302\n",
      "MSE : 0.017880769126694434\n",
      "epoch : 35  w : 9.580336163678965  b : 5.21782507462906\n",
      "MSE : 0.015488978678351549\n",
      "epoch : 36  w : 9.609411151778739  b : 5.20273380179461\n",
      "MSE : 0.013417121981641529\n",
      "epoch : 37  w : 9.63647177776332  b : 5.188688076705991\n",
      "MSE : 0.011622403646397597\n",
      "epoch : 38  w : 9.661657599892102  b : 5.1756154621274035\n",
      "MSE : 0.010067752734500364\n",
      "epoch : 39  w : 9.685098507602962  b : 5.163448539391691\n",
      "MSE : 0.008721057038356753\n",
      "epoch : 40  w : 9.70691539138382  b : 5.152124560705799\n",
      "MSE : 0.007554499784806958\n",
      "epoch : 41  w : 9.727220766234428  b : 5.141585125545079\n",
      "MSE : 0.006543985063696059\n",
      "epoch : 42  w : 9.746119351933704  b : 5.131775879467513\n",
      "MSE : 0.005668640113009343\n",
      "epoch : 43  w : 9.76370861310522  b : 5.122646233794579\n",
      "MSE : 0.004910384179983039\n",
      "epoch : 44  w : 9.780079261866076  b : 5.114149104713073\n",
      "MSE : 0.004253555052770388\n",
      "epoch : 45  w : 9.795315725651452  b : 5.106240670452386\n",
      "MSE : 0.003684585548459268\n",
      "epoch : 46  w : 9.809496582627517  b : 5.098880145284923\n",
      "MSE : 0.0031917232751160823\n",
      "epoch : 47  w : 9.822694966938226  b : 5.092029569184141\n",
      "MSE : 0.002764787879379686\n",
      "epoch : 48  w : 9.834978945875973  b : 5.085653612055423\n",
      "MSE : 0.0023949607654149673\n",
      "epoch : 49  w : 9.84641187092124  b : 5.079719391530142\n",
      "MSE : 0.0020746029417504754\n",
      "epoch : 50  w : 9.857052704461674  b : 5.0741963033832596\n",
      "MSE : 0.001797097233521443\n",
      "epoch : 51  w : 9.866956323875506  b : 5.069055863699852\n",
      "MSE : 0.0015567116009222609\n",
      "epoch : 52  w : 9.87617380454761  b : 5.06427156197661\n",
      "MSE : 0.0013484807406315708\n",
      "epoch : 53  w : 9.884752683277739  b : 5.059818724400692\n",
      "MSE : 0.0011681035246201062\n",
      "epoch : 54  w : 9.892737203439413  b : 5.055674386600846\n",
      "MSE : 0.00101185415788056\n",
      "epoch : 55  w : 9.900168543153807  b : 5.0518171752145316\n",
      "MSE : 0.0008765052199916649\n"
     ]
    }
   ],
   "source": [
    "for epoch in range(num_epoch):\n",
    "    # MSE 구현하기\n",
    "    y_pre = w * x + b\n",
    "    mse = ((y_pre-y)**2).mean()\n",
    "    print(\"MSE :\", mse)\n",
    "    \n",
    "    # MSE가 일정 수준이하로 떨어지면 반복을 멈춤\n",
    "    if mse < 0.001 :\n",
    "        break\n",
    "        \n",
    "    # 경사하강법을 이용해 w,b 업데이트\n",
    "    w = w - learning_rate * ((y_pre-y)*x).mean()\n",
    "    b = b - learning_rate * ((y_pre-y)*1).mean()\n",
    "    \n",
    "    # 중간결과 출력\n",
    "    print(\"epoch :\",(epoch+1),\" w :\",w,\" b :\",b)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9a53e98a",
   "metadata": {},
   "source": [
    "### 입력특성이 2개인 경우 구현"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0b7045dc",
   "metadata": {},
   "source": [
    "#### 문제 생성(x1 : 공부한시간, x2 : 잠자는시간)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "23653835",
   "metadata": {},
   "outputs": [],
   "source": [
    "x1 = np.random.uniform(low=0.0,high=1.0,size=100)\n",
    "x2 = np.random.uniform(low=0.0,high=1.0,size=100)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "25b33624",
   "metadata": {},
   "source": [
    "#### 정답생성(성적)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "6d6b69c2",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(100,)\n",
      "[ 2.91016812 12.06182643  0.3798479   9.58348002  9.22554672  7.33867999\n",
      "  8.74635761  3.3572068   6.69779855  9.79517478  7.02114174  5.1771663\n",
      "  1.38523852  0.99813609 10.89201864 10.43850857  0.91685248  4.42050699\n",
      "  7.09873389 13.32644923 12.30077658  1.890583    8.55312432  4.14511131\n",
      "  4.8046469   6.36648424  4.68523891  6.80266017 11.48800351  3.63620867\n",
      " 12.53919141  1.19324983 13.28734539  5.02623598  8.81684944  3.32345786\n",
      "  2.53460331  6.57493705  8.26868373  4.28186439  3.85707196 11.02254086\n",
      "  4.10658151  8.15537075 10.74752831  3.0618177   5.93049659  7.69893324\n",
      "  0.92661334 -0.27384791  2.33219599  9.17846638  4.50508119  9.4563901\n",
      "  8.42671268  3.13892645  4.91006166  5.86780755  2.91676641  7.16924062\n",
      "  3.30519188  1.31214621  4.16165634  3.98186607  1.48864566  6.5821553\n",
      " 15.38574551  7.31594191  8.7903526  13.12282524  8.6801525   7.26202259\n",
      "  6.95394186  4.90941359  4.14948814  7.1002168   8.66078898 14.61278702\n",
      " 10.74163312  5.44405586 12.61129499 13.04281389  8.84158637 11.13061056\n",
      "  2.75254717  7.08212288 12.88448803  4.72698316  6.08324949  6.10978282\n",
      "  5.58634407  6.68536048  5.31325663 12.13288837  4.00008216  9.51532469\n",
      "  4.25103258 13.55763905  6.06436704  1.32687221]\n"
     ]
    }
   ],
   "source": [
    "y = 13 * x1 + 5 * x2 - 2\n",
    "print(y.shape)\n",
    "print(y)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1202bab1",
   "metadata": {},
   "source": [
    "#### 학습"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "a2cdc4a4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "초기 가중치(w1) : 0.41234239765066194\n",
      "초기 가중치(w2) : 0.19621186374367394\n",
      "초기 절편 : 0.45465522075026155\n"
     ]
    }
   ],
   "source": [
    "num_epoch = 500 # 경사하강법을 적용할 최대 반복 횟수\n",
    "learning_rate = 1.0 # 학습률\n",
    "\n",
    "# 초기 가중치와 절편을 셋팅\n",
    "w1 = np.random.uniform(low=0.0, high=1.0)\n",
    "w2 = np.random.uniform(low=0.0, high=1.0)\n",
    "b = np.random.uniform(low=0.0, high=1.0)\n",
    "\n",
    "\n",
    "print(\"초기 가중치(w1) :\",w1)\n",
    "print(\"초기 가중치(w2) :\",w2)\n",
    "print(\"초기 절편 :\",b)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "22cec752",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MSE : 48.57263353347178\n",
      "epoch : 1  w1 : 4.228274426893561  w2 : 3.364328809329385  b : 6.435118284506439\n",
      "MSE : 17.630493678923198\n",
      "epoch : 2  w1 : 3.2726380650411677  w2 : 1.6700968270738015  b : 3.0226848051403925\n",
      "MSE : 9.253493262261314\n",
      "epoch : 3  w1 : 4.635594544480114  w2 : 2.4354580360311378  b : 4.327376755205352\n",
      "MSE : 6.604089594265503\n",
      "epoch : 4  w1 : 4.776458712818711  w2 : 1.995452585735539  b : 3.2915198319720465\n",
      "MSE : 5.4588870216074925\n",
      "epoch : 5  w1 : 5.470795662054114  w2 : 2.1801616834993296  b : 3.4438369006623644\n",
      "MSE : 4.7513453924048505\n",
      "epoch : 6  w1 : 5.835031339094556  w2 : 2.0717702236764235  b : 3.0186612411737874\n",
      "MSE : 4.206055064406863\n",
      "epoch : 7  w1 : 6.315117885981089  w2 : 2.1269810352742806  b : 2.8981948398979567\n",
      "MSE : 3.7467844495237173\n",
      "epoch : 8  w1 : 6.691761222050008  w2 : 2.1153005494674875  b : 2.640441433310599\n",
      "MSE : 3.3482183185538528\n",
      "epoch : 9  w1 : 7.078069021769196  w2 : 2.1501183119175793  b : 2.4657042434149186\n",
      "MSE : 2.998703614345784\n",
      "epoch : 10  w1 : 7.420634133956217  w2 : 2.1730274491640538  b : 2.263100514108389\n",
      "MSE : 2.690787542359166\n",
      "epoch : 11  w1 : 7.749074280732083  w2 : 2.2117082655531264  b : 2.0874184747698687\n",
      "MSE : 2.4187299247447713\n",
      "epoch : 12  w1 : 8.051253647162849  w2 : 2.250940736510839  b : 1.9106279289306032\n",
      "MSE : 2.1777791676830627\n",
      "epoch : 13  w1 : 8.335705821803963  w2 : 2.2970994227267143  b : 1.7461519026687793\n",
      "MSE : 1.9639054693022353\n",
      "epoch : 14  w1 : 8.600432438103399  w2 : 2.3458856424969334  b : 1.5867140667182853\n",
      "MSE : 1.7736619267116507\n",
      "epoch : 15  w1 : 8.848523518462795  w2 : 2.398453526714217  b : 1.4354203558654375\n",
      "MSE : 1.604088994067923\n",
      "epoch : 16  w1 : 9.080360119053108  w2 : 2.453334467715252  b : 1.2902126581249989\n",
      "MSE : 1.452639322901091\n",
      "epoch : 17  w1 : 9.297527353804483  w2 : 2.510466158661592  b : 1.1516420829147398\n",
      "MSE : 1.3171157128730777\n",
      "epoch : 18  w1 : 9.500869728808889  w2 : 2.5691687718300193  b : 1.0189798139928958\n",
      "MSE : 1.1956190741458277\n",
      "epoch : 19  w1 : 9.691474983331771  w2 : 2.629149063474751  b : 0.8921606513017788\n",
      "MSE : 1.0865045530662463\n",
      "epoch : 20  w1 : 9.870192392293584  w2 : 2.6899908748750025  b : 0.7708096229950318\n",
      "MSE : 0.9883444588477546\n",
      "epoch : 21  w1 : 10.037883149158544  w2 : 2.7514032668530253  b : 0.6547274989344477\n",
      "MSE : 0.8998968955498757\n",
      "epoch : 22  w1 : 10.195303833827426  w2 : 2.8130903449903424  b : 0.5436467682144049\n",
      "MSE : 0.8200791918738979\n",
      "epoch : 23  w1 : 10.343172659014783  w2 : 2.874810828584001  b : 0.4373525505304622\n",
      "MSE : 0.747945370190125\n",
      "epoch : 24  w1 : 10.482143644528625  w2 : 2.9363432224684534  b : 0.3356210718222281\n",
      "MSE : 0.6826670187746399\n",
      "epoch : 25  w1 : 10.612826232758302  w2 : 2.997498652151632  b : 0.2382494479546976\n",
      "MSE : 0.6235170333932504\n",
      "epoch : 26  w1 : 10.735781623494784  w2 : 3.058110275651511  b : 0.1450398673500776\n",
      "MSE : 0.5698557798581385\n",
      "epoch : 27  w1 : 10.851530243745557  w2 : 3.1180347874535066  b : 0.05580663861630128\n",
      "MSE : 0.5211193008127809\n",
      "epoch : 28  w1 : 10.9605531833514  w2 : 3.1771482195799474  b : -0.029628142153595674\n",
      "MSE : 0.4768092500510426\n",
      "epoch : 29  w1 : 11.063296222094221  w2 : 3.2353449091118014  b : -0.11143318163618178\n",
      "MSE : 0.4364842880345578\n",
      "epoch : 30  w1 : 11.16017217020147  w2 : 3.292535168807372  b : -0.1897694041025977\n",
      "MSE : 0.39975271451394506\n",
      "epoch : 31  w1 : 11.251563694536218  w2 : 3.3486438677708383  b : -0.2647899096331371\n",
      "MSE : 0.36626614960145254\n",
      "epoch : 32  w1 : 11.337825574041876  w2 : 3.403608795370873  b : -0.3366406198949758\n",
      "MSE : 0.33571410438813415\n",
      "epoch : 33  w1 : 11.419286940216441  w2 : 3.457379350876629  b : -0.405460541988133\n",
      "MSE : 0.3078193071706315\n",
      "epoch : 34  w1 : 11.496253249779715  w2 : 3.5099152682751598  b : -0.4713821878607717\n",
      "MSE : 0.2823336723241001\n",
      "epoch : 35  w1 : 11.569008138975938  w2 : 3.561185504003635  b : -0.534531882908886\n",
      "MSE : 0.2590348164759151\n",
      "epoch : 36  w1 : 11.637815105825773  w2 : 3.6111672076719437  b : -0.5950300992300126\n",
      "MSE : 0.23772304144157588\n",
      "epoch : 37  w1 : 11.702919066452855  w2 : 3.659844801099363  b : -0.6529917478576502\n",
      "MSE : 0.21821871583353109\n",
      "epoch : 38  w1 : 11.764547780066717  w2 : 3.7072091396272673  b : -0.708526464743251\n",
      "MSE : 0.20035999772576665\n",
      "epoch : 39  w1 : 11.822913161473544  w2 : 3.7532567565217114  b : -0.7617388748780862\n",
      "MSE : 0.18400084957033433\n",
      "epoch : 40  w1 : 11.878212486476738  w2 : 3.7979891789152282  b : -0.8127288440091344\n",
      "MSE : 0.16900930398340538\n",
      "epoch : 41  w1 : 11.930629501039203  w2 : 3.8414123108937037  b : -0.8615917147483194\n",
      "MSE : 0.1552659452714733\n",
      "epoch : 42  w1 : 11.980335441182964  w2 : 3.8835358766440415  b : -0.9084185300918465\n",
      "MSE : 0.14266257684035025\n",
      "epoch : 43  w1 : 12.02748997150635  w2 : 3.9243729187359575  b : -0.9532962441542254\n",
      "MSE : 0.1311010490776114\n",
      "epoch : 44  w1 : 12.072242048790974  w2 : 3.963939346274282  b : -0.996307921433361\n",
      "MSE : 0.12049222605481019\n",
      "epoch : 45  w1 : 12.11473071700033  w2 : 4.002253528504695  b : -1.0375329250796785\n",
      "MSE : 0.11075507256943293\n",
      "epoch : 46  w1 : 12.155085839256444  w2 : 4.039335929651838  b : -1.0770470949835314\n",
      "MSE : 0.10181584573079959\n",
      "epoch : 47  w1 : 12.193428772006019  w2 : 4.075208781236554  b : -1.1149229162501144\n",
      "MSE : 0.0936073775665286\n",
      "epoch : 48  w1 : 12.229872986104269  w2 : 4.109895788401902  b : -1.1512296786850682\n",
      "MSE : 0.08606843705194417\n",
      "epoch : 49  w1 : 12.264524639172198  w2 : 4.143421867108202  b : -1.1860336278236019\n",
      "MSE : 0.07914316159859176\n",
      "epoch : 50  w1 : 12.297483103207234  w2 : 4.175812909323186  b : -1.2193981080226401\n",
      "MSE : 0.07278054942569058\n",
      "epoch : 51  w1 : 12.32884145110043  w2 : 4.207095573594167  b : -1.2513836980880804\n",
      "MSE : 0.06693400541848618\n",
      "epoch : 52  w1 : 12.358686905405634  w2 : 4.2372970986182565  b : -1.2820483398829785\n",
      "MSE : 0.061560934082421886\n",
      "epoch : 53  w1 : 12.387101252428577  w2 : 4.2664451376404084  b : -1.311447460329382\n",
      "MSE : 0.0566223740590357\n",
      "epoch : 54  w1 : 12.41416122444761  w2 : 4.294567611701948  b : -1.3396340871902932\n",
      "MSE : 0.05208266940139716\n",
      "epoch : 55  w1 : 12.439938852644213  w2 : 4.321692579939435  b : -1.366658958991812\n",
      "MSE : 0.04790917343297253\n",
      "epoch : 56  w1 : 12.464501793107083  w2 : 4.3478481252949575  b : -1.3925706294220126\n",
      "MSE : 0.04407198155022024\n",
      "epoch : 57  w1 : 12.487913628077463  w2 : 4.3730622541462845  b : -1.4174155665209562\n",
      "MSE : 0.04054368978964654\n",
      "epoch : 58  w1 : 12.510234144423722  w2 : 4.397362808499777  b : -1.4412382469557887\n",
      "MSE : 0.037299176375939935\n",
      "epoch : 59  w1 : 12.531519591168605  w2 : 4.4207773895115885  b : -1.4640812456559633\n",
      "MSE : 0.034315403808874684\n",
      "epoch : 60  w1 : 12.551822917741944  w2 : 4.443333291214657  b : -1.4859853210659684\n",
      "MSE : 0.03157123934108371\n",
      "epoch : 61  w1 : 12.571193994493477  w2 : 4.465057443431061  b : -1.506989496256679\n",
      "MSE : 0.02904729195344558\n",
      "epoch : 62  w1 : 12.589679816874007  w2 : 4.4859763629424965  b : -1.5271311361212327\n",
      "MSE : 0.026725764155557205\n",
      "epoch : 63  w1 : 12.607324694577276  w2 : 4.506116112076546  b : -1.5464460208672661\n",
      "MSE : 0.024590317130485376\n",
      "epoch : 64  w1 : 12.624170426828764  w2 : 4.525502263943902  b : -1.5649684160042285\n",
      "MSE : 0.022625947909886753\n",
      "epoch : 65  w1 : 12.64025646491036  w2 : 4.544159873632301  b : -1.5827311390123484\n",
      "MSE : 0.020818877411208848\n",
      "epoch : 66  w1 : 12.655620062920756  w2 : 4.562113454727357  b : -1.5997656228684065\n",
      "MSE : 0.01915644829600304\n",
      "epoch : 67  w1 : 12.670296417689718  w2 : 4.5793869605891055  b : -1.616101976593009\n",
      "MSE : 0.017627031719981194\n",
      "epoch : 68  w1 : 12.684318798689539  w2 : 4.596003769866599  b : -1.6317690429741414\n",
      "MSE : 0.01621994214346244\n",
      "epoch : 69  w1 : 12.697718668718387  w2 : 4.611986675781569  b : -1.6467944536126569\n",
      "MSE : 0.0149253594571594\n",
      "epoch : 70  w1 : 12.710525796067344  w2 : 4.627357878756572  b : -1.6612046814267882\n",
      "MSE : 0.01373425775439515\n",
      "epoch : 71  w1 : 12.722768358825302  w2 : 4.642138982003453  b : -1.6750250907447886\n",
      "MSE : 0.012638340148183618\n",
      "epoch : 72  w1 : 12.734473041922994  w2 : 4.656350989724718  b : -1.6882799851073897\n",
      "MSE : 0.011629979091286428\n",
      "epoch : 73  w1 : 12.745665127469007  w2 : 4.67001430761397  b : -1.7009926528947417\n",
      "MSE : 0.010702161710365733\n",
      "epoch : 74  w1 : 12.756368578886097  w2 : 4.683148745371956  b : -1.713185410886085\n",
      "MSE : 0.009848439712530872\n",
      "epoch : 75  w1 : 12.766606119315465  w2 : 4.695773520982578  b : -1.7248796458542288\n",
      "MSE : 0.0090628834646561\n",
      "epoch : 76  w1 : 12.776399304719138  w2 : 4.70790726651838  b : -1.736095854291298\n",
      "MSE : 0.0083400398834439\n",
      "epoch : 77  w1 : 12.785768592076387  w2 : 4.719568035268  b : -1.7468536803568167\n",
      "MSE : 0.007674893807873935\n",
      "epoch : 78  w1 : 12.79473340303857  w2 : 4.73077330999886  b : -1.7571719521342661\n",
      "MSE : 0.0070628325558754245\n",
      "epoch : 79  w1 : 12.803312183377946  w2 : 4.741540012187372  b : -1.7670687162775087\n",
      "MSE : 0.006499613394187873\n",
      "epoch : 80  w1 : 12.811522458539448  w2 : 4.751884512066054  b : -1.7765612711241472\n",
      "MSE : 0.005981333674799004\n",
      "epoch : 81  w1 : 12.819380885580134  w2 : 4.761822639352635  b : -1.78566619834871\n",
      "MSE : 0.005504403413356552\n",
      "epoch : 82  w1 : 12.8269033017586  w2 : 4.771369694540339  b : -1.7943993932247457\n",
      "MSE : 0.00506552010482762\n",
      "epoch : 83  w1 : 12.83410477001622  w2 : 4.780540460641431  b : -1.8027760935612107\n",
      "MSE : 0.004661645589643782\n",
      "epoch : 84  w1 : 12.840999621573163  w2 : 4.7893492152877295  b : -1.8108109073751892\n",
      "MSE : 0.004289984799836447\n",
      "epoch : 85  w1 : 12.84760149584488  w2 : 4.797809743102367  b : -1.818517839359714\n",
      "MSE : 0.003947966229410576\n",
      "epoch : 86  w1 : 12.853923377868814  w2 : 4.805935348266626  b : -1.825910316202476\n",
      "MSE : 0.003633223986585342\n",
      "epoch : 87  w1 : 12.859977633416502  w2 : 4.813738867214348  b : -1.8330012108083342\n",
      "MSE : 0.003343581297684488\n",
      "epoch : 88  w1 : 12.865776041952822  w2 : 4.821232681394228  b : -1.8398028654758882\n",
      "MSE : 0.0030770353435154653\n",
      "epoch : 89  w1 : 12.871329827591738  w2 : 4.8284287300473965  b : -1.8463271140758133\n",
      "MSE : 0.0028317433191380028\n",
      "epoch : 90  w1 : 12.87664968818661  w2 : 4.835338522954063  b : -1.852585303276321\n",
      "MSE : 0.0026060096170938836\n",
      "epoch : 91  w1 : 12.881745822682662  w2 : 4.8419731531088  b : -1.8585883128588003\n",
      "MSE : 0.00239827404252683\n",
      "epoch : 92  w1 : 12.8866279568496  w2 : 4.848343309289193  b : -1.8643465751646429\n",
      "MSE : 0.002207100976254763\n",
      "epoch : 93  w1 : 12.89130536750355  w2 : 4.854459288487339  b : -1.8698700937121864\n",
      "MSE : 0.0020311694088206195\n",
      "epoch : 94  w1 : 12.895786905319346  w2 : 4.860331008177834  b : -1.8751684610208612\n",
      "MSE : 0.0018692637749172822\n",
      "epoch : 95  w1 : 12.900081016326695  w2 : 4.865968018399714  b : -1.8802508756778167\n",
      "MSE : 0.0017202655234020453\n",
      "epoch : 96  w1 : 12.9041957621769  w2 : 4.871379513633234  b : -1.8851261586806016\n",
      "MSE : 0.0015831453634418482\n",
      "epoch : 97  w1 : 12.908138839260419  w2 : 4.876574344455374  b : -1.889802769087903\n",
      "MSE : 0.0014569561322061732\n",
      "epoch : 98  w1 : 12.911917596749705  w2 : 4.881561028960769  b : -1.8942888190087828\n",
      "MSE : 0.0013408262339877181\n",
      "epoch : 99  w1 : 12.915539053636415  w2 : 4.886347763937149  b : -1.8985920879594613\n",
      "MSE : 0.001233953604720463\n",
      "epoch : 100  w1 : 12.919009914827047  w2 : 4.890942435786584  b : -1.902720036615306\n",
      "MSE : 0.0011356001596138255\n",
      "epoch : 101  w1 : 12.922336586356513  w2 : 4.895352631185796  b : -1.906679819984398\n",
      "MSE : 0.0010450866850571334\n",
      "epoch : 102  w1 : 12.925525189774936  w2 : 4.899585647480494  b : -1.9104783000278367\n",
      "MSE : 0.0009617881391011553\n"
     ]
    }
   ],
   "source": [
    "for epoch in range(num_epoch):\n",
    "    # MSE 구현하기\n",
    "    y_pre = w1 * x1 + w2 * x2 + b   \n",
    "    mse = ((y_pre-y)**2).mean()\n",
    "    print(\"MSE :\", mse)\n",
    "    \n",
    "    # MSE가 일정 수준이하로 떨어지면 반복을 멈춤\n",
    "    if mse < 0.001 :\n",
    "        break\n",
    "        \n",
    "    # 경사하강법을 이용해 w,b 업데이트\n",
    "    w1 = w1 - learning_rate * ((y_pre-y)*x1).mean()\n",
    "    w2 = w2 - learning_rate * ((y_pre-y)*x2).mean()\n",
    "    b = b - learning_rate * ((y_pre-y)*1).mean()\n",
    "    \n",
    "    # 중간결과 출력\n",
    "    print(\"epoch :\",(epoch+1),\" w1 :\",w1,\" w2 :\",w2,\" b :\",b)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "8263f670",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "baeb3ad6",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
